import os
import json
import random
import re

# å®Œæ•´çš„ Unicode Emoji åˆ—è¡¨ï¼ˆæ”¶å½•å¸¸ç”¨è¡¨æƒ…ã€äººç‰©ã€åŠ¨ç‰©ã€ç‰©å“ã€æ——å¸œç­‰ï¼Œå¯æ ¹æ®éœ€è¦ç»§ç»­æ‰©å……ï¼‰
ALL_EMOJIS = [
    "ğŸ˜€", "ğŸ˜", "ğŸ˜‚", "ğŸ¤£", "ğŸ˜ƒ", "ğŸ˜„", "ğŸ˜…", "ğŸ˜†", "ğŸ˜‰", "ğŸ˜Š", "ğŸ˜‹", "ğŸ˜", "ğŸ˜", "ğŸ˜˜", "ğŸ¥°",
    "ğŸ˜—", "ğŸ˜™", "ğŸ˜š", "ğŸ™‚", "ğŸ¤—", "ğŸ¤©", "ğŸ¤”", "ğŸ¤¨", "ğŸ˜", "ğŸ˜‘", "ğŸ˜¶", "ğŸ™„", "ğŸ˜", "ğŸ˜£", "ğŸ˜¥",
    "ğŸ˜®", "ğŸ¤", "ğŸ˜¯", "ğŸ˜ª", "ğŸ˜«", "ğŸ¥±", "ğŸ˜´", "ğŸ˜Œ", "ğŸ˜›", "ğŸ˜œ", "ğŸ˜", "ğŸ¤¤", "ğŸ˜’", "ğŸ˜“", "ğŸ˜”",
    "ğŸ˜•", "ğŸ™ƒ", "ğŸ¤‘", "ğŸ˜²", "â˜¹ï¸", "ğŸ™", "ğŸ˜–", "ğŸ˜", "ğŸ˜Ÿ", "ğŸ˜¤", "ğŸ˜¢", "ğŸ˜­", "ğŸ˜¦", "ğŸ˜§", "ğŸ˜¨",
    "ğŸ˜©", "ğŸ¤¯", "ğŸ˜¬", "ğŸ˜°", "ğŸ˜±", "ğŸ¥µ", "ğŸ¥¶", "ğŸ˜³", "ğŸ¤ª", "ğŸ˜µ", "ğŸ˜¡", "ğŸ˜ ", "ğŸ¤¬", "ğŸ˜·", "ğŸ¤’",
    "ğŸ¤•", "ğŸ¤¢", "ğŸ¤®", "ğŸ¤§", "ğŸ˜‡", "ğŸ¥³", "ğŸ¥º", "ğŸ¥²", "ğŸ¤ ", "ğŸ¥¸", "ğŸ¤“", "ğŸ§", "ğŸ« ", "ğŸ¤–", "ğŸ‘»",
    "ğŸ’€", "â˜ ï¸", "ğŸ‘½", "ğŸ‘¾", "ğŸ‘¹", "ğŸ‘º", "ğŸ’©", "ğŸ˜º", "ğŸ˜¸", "ğŸ˜¹", "ğŸ˜»", "ğŸ˜¼", "ğŸ˜½", "ğŸ™€", "ğŸ˜¿",
    "ğŸ˜¾", "ğŸ™ˆ", "ğŸ™‰", "ğŸ™Š", "ğŸµ", "ğŸ’", "ğŸ¦", "ğŸ¦§", "ğŸ¶", "ğŸ•", "ğŸ¦®", "ğŸ•â€ğŸ¦º", "ğŸ©", "ğŸº", "ğŸ¦Š",
    "ğŸ¦", "ğŸ±", "ğŸˆ", "ğŸˆâ€â¬›", "ğŸ¦", "ğŸ¯", "ğŸ…", "ğŸ†", "ğŸ´", "ğŸ¦„", "ğŸ®", "ğŸ‚", "ğŸƒ", "ğŸ„", "ğŸ·",
    "ğŸ–", "ğŸ—", "ğŸ½", "ğŸ", "ğŸ‘", "ğŸ", "ğŸª", "ğŸ«", "ğŸ¦™", "ğŸ¦’", "ğŸ˜", "ğŸ¦£", "ğŸ¦", "ğŸ¦›", "ğŸ­",
    "ğŸ", "ğŸ€", "ğŸ¹", "ğŸ°", "ğŸ‡", "ğŸ¿ï¸", "ğŸ¦«", "ğŸ¦”", "ğŸ¦‡", "ğŸ»", "ğŸ»â€â„ï¸", "ğŸ¨", "ğŸ¼", "ğŸ¦¥", "ğŸ¦¦",
    "ğŸ¦¨", "ğŸ¦˜", "ğŸ¦¡", "ğŸ¾", "ğŸ¦ƒ", "ğŸ”", "ğŸ“", "ğŸ£", "ğŸ¤", "ğŸ¥", "ğŸ¦", "ğŸ§", "ğŸ•Šï¸", "ğŸ¦…", "ğŸ¦†",
    "ğŸ¦¢", "ğŸ¦‰", "ğŸ¦©", "ğŸ¦š", "ğŸ¦œ", "ğŸ¦¤", "ğŸ¦¥", "ğŸ¦¦", "ğŸ¦¨", "ğŸ¦©", "ğŸ¦ª", "ğŸ¦‘", "ğŸ¦", "ğŸ¦", "ğŸ¦€",
    "ğŸ¡", "ğŸ ", "ğŸŸ", "ğŸ¬", "ğŸ³", "ğŸ‹", "ğŸ¦ˆ", "ğŸŠ", "ğŸ¢", "ğŸ", "ğŸ¦", "ğŸ¦–", "ğŸ¦•", "ğŸ™", "ğŸ§‘â€ğŸ’»",
    "ğŸ‘¨â€ğŸ’»", "ğŸ‘©â€ğŸ’»", "ğŸ‘¨â€ğŸ”¬", "ğŸ‘©â€ğŸ”¬", "ğŸ‘¨â€ğŸ“", "ğŸ‘©â€ğŸ“", "ğŸ‘¨â€ğŸ«", "ğŸ‘©â€ğŸ«", "ğŸ‘¨â€âš•ï¸", "ğŸ‘©â€âš•ï¸", "ğŸ‘¨â€ğŸ³",
    "ğŸ‘©â€ğŸ³", "ğŸ‘¨â€âœˆï¸", "ğŸ‘©â€âœˆï¸", "ğŸ‘®â€â™‚ï¸", "ğŸ‘®â€â™€ï¸", "ğŸ•µï¸â€â™‚ï¸", "ğŸ•µï¸â€â™€ï¸", "ğŸ’‚â€â™‚ï¸", "ğŸ’‚â€â™€ï¸", "ğŸ•µï¸", "ğŸ‘·â€â™‚ï¸",
    "ğŸ‘·â€â™€ï¸", "ğŸ‘·", "ğŸ¤´", "ğŸ‘¸", "ğŸ‘³â€â™‚ï¸", "ğŸ‘³â€â™€ï¸", "ğŸ‘²", "ğŸ§•", "ğŸ§‘â€ğŸ¤", "ğŸ‘¨â€ğŸ¤", "ğŸ‘©â€ğŸ¤", "ğŸ‘¨â€ğŸ¨", "ğŸ‘©â€ğŸ¨",
    "ğŸ§‘â€ğŸš€", "ğŸ‘¨â€ğŸš€", "ğŸ‘©â€ğŸš€", "ğŸ§‘â€ğŸš’", "ğŸ‘¨â€ğŸš’", "ğŸ‘©â€ğŸš’", "ğŸ§‘â€âš–ï¸", "ğŸ‘¨â€âš–ï¸", "ğŸ‘©â€âš–ï¸",
    "âš½", "ğŸ€", "ğŸˆ", "âš¾", "ğŸ¾", "ğŸ", "ğŸ‰", "ğŸ¥", "ğŸ±", "ğŸ“", "ğŸ¸", "ğŸ¥…", "ğŸ’", "ğŸ‘", "ğŸ¥",
    "ğŸ", "â›³", "ğŸ¹", "ğŸ£", "ğŸ¤¿", "ğŸ¥Š", "ğŸ¥‹", "ğŸ½", "ğŸ›¹", "ğŸ›·", "â›¸ï¸", "ğŸ¥Œ", "ğŸ›¶", "â›µ", "ğŸš¤",
    "ğŸ›¥ï¸", "ğŸ›³ï¸", "â›´ï¸", "ğŸš¢", "âœˆï¸", "ğŸ›©ï¸", "ğŸš", "ğŸšŸ", "ğŸš ", "ğŸš¡", "ğŸš€", "ğŸ›¸",
    "â¤ï¸", "ğŸ’›", "ğŸ’š", "ğŸ’™", "ğŸ’œ", "ğŸ–¤", "ğŸ¤", "ğŸ¤", "ğŸ’”", "â£ï¸", "ğŸ’•", "ğŸ’", "ğŸ’“", "ğŸ’—", "ğŸ’–",
    "ğŸ’˜", "ğŸ’", "ğŸ’Ÿ", "â˜®ï¸", "âœï¸", "â˜ªï¸", "ğŸ•‰ï¸", "â˜¸ï¸", "âœ¡ï¸", "ğŸ”¯", "ğŸ•", "â˜¯ï¸", "â˜¦ï¸", "ğŸ›",
    "â›", "â™ˆ", "â™‰", "â™Š", "â™‹", "â™Œ", "â™", "â™", "â™", "â™", "â™‘", "â™’", "â™“", "ğŸ†”", "âš›ï¸", "ğŸ‰‘",
    "ğŸ³ï¸", "ğŸ´", "ğŸ", "ğŸš©", "ğŸ³ï¸â€ğŸŒˆ", "ğŸ³ï¸â€âš§ï¸", "ğŸ‡¨ğŸ‡³", "ğŸ‡ºğŸ‡¸", "ğŸ‡¬ğŸ‡§", "ğŸ‡«ğŸ‡·", "ğŸ‡¯ğŸ‡µ", "ğŸ‡°ğŸ‡·", "ğŸ‡©ğŸ‡ª", "ğŸ‡·ğŸ‡º", "ğŸ‡®ğŸ‡³"
]

# Emojiæ­£åˆ™è¡¨è¾¾å¼ï¼Œç²¾å‡†åŒ¹é…æ‰€æœ‰emojiï¼ˆæ”¯æŒå•å­—ç¬¦å’Œå¤åˆemojiï¼Œé€‚é…å¤šç§UnicodeåŒºæ®µï¼‰
EMOJI_PATTERN = re.compile(
    "[" +
    "\U0001F600-\U0001F64F" +  # è¡¨æƒ…
    "\U0001F300-\U0001F5FF" +  # ç¬¦å·å’Œè±¡å½¢æ–‡å­—
    "\U0001F680-\U0001F6FF" +  # äº¤é€šè¿è¾“
    "\U0001F1E0-\U0001F1FF" +  # æ——å¸œ
    "\U00002700-\U000027BF" +  # Dingbats
    "\U0001F900-\U0001F9FF" +  # è¡¥å……è¡¨æƒ…
    "\U00002600-\U000026FF" +  # æ‚é¡¹ç¬¦å·
    "\U0001F700-\U0001F77F" +  # ç‚¼é‡‘æœ¯ç¬¦å·
    "\U0001FA70-\U0001FAFF" +  # è¡¥å……è±¡å½¢æ–‡å­—
    "\U0001F780-\U0001F7FF" +  # å‡ ä½•æ‰©å±•
    "\U0001F800-\U0001F8FF" +  # è¡¥å……ç®­å¤´
    "\U0001FA00-\U0001FA6F" +  # å›½é™…è±¡æ£‹ç¬¦å·
    "]+", flags=re.UNICODE
)

def random_emoji():
    """
    éšæœºè¿”å›ä¸€ä¸ªæ–°çš„emojiè¡¨æƒ…
    """
    return random.choice(ALL_EMOJIS)

def replace_emojis_in_str(s):
    """
    å°†å­—ç¬¦ä¸²ä¸­æ‰€æœ‰emojiç²¾å‡†æ›¿æ¢ä¸ºéšæœºæ–°emojiï¼ˆæ•°é‡ã€ä½ç½®ä¸å˜ï¼‰
    """
    def repl(match):
        return random_emoji()
    return EMOJI_PATTERN.sub(repl, s)

def process_json_emojis(obj):
    """
    é€’å½’éå†JSONå¯¹è±¡ï¼Œå¯¹æ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µä¸­çš„emojiç²¾å‡†æ›¿æ¢
    """
    if isinstance(obj, dict):
        return {k: process_json_emojis(v) for k, v in obj.items()}
    elif isinstance(obj, list):
        return [process_json_emojis(i) for i in obj]
    elif isinstance(obj, str):
        return replace_emojis_in_str(obj)
    else:
        return obj

def update_emojis_in_json_file(input_path, output_path):
    """
    å¤„ç†å•ä¸ªjsonæ–‡ä»¶ï¼Œå°†å…¶ä¸­æ‰€æœ‰emojiæ›¿æ¢åå†™å…¥output_path
    """
    try:
        with open(input_path, 'r', encoding='utf-8') as f:
            data = json.load(f)
    except Exception as e:
        print(f"è¯»å–æ–‡ä»¶å¤±è´¥: {input_path}, é”™è¯¯: {e}")
        return

    new_data = process_json_emojis(data)
    try:
        with open(output_path, 'w', encoding='utf-8') as f:
            json.dump(new_data, f, ensure_ascii=False, indent=2)
        print(f"å·²ç”Ÿæˆæ–‡ä»¶: {output_path}")
    except Exception as e:
        print(f"å†™å…¥æ–‡ä»¶å¤±è´¥: {output_path}, é”™è¯¯: {e}")

def main():
    """
    ä¸»ç¨‹åºï¼Œè‡ªåŠ¨æŸ¥æ‰¾å¹¶å¤„ç†emojisæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰jsonæ–‡ä»¶ï¼Œå°†ç»“æœè¾“å‡ºåˆ°outputç›®å½•ä¸‹ï¼ˆå¯è¦†ç›–æ—§æ–‡ä»¶ï¼‰
    """
    base_dir = os.path.dirname(os.path.abspath(__file__))
    emojis_dir = base_dir
    output_dir = os.path.join(emojis_dir, "output")
    os.makedirs(output_dir, exist_ok=True)

    for file in os.listdir(emojis_dir):
        if file.endswith('.json'):
            input_path = os.path.join(emojis_dir, file)
            output_path = os.path.join(output_dir, file)
            update_emojis_in_json_file(input_path, output_path)

if __name__ == "__main__":
    main()
