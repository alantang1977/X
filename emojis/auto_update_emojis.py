import os
import random
import re

# å®‰å“ç³»ç»Ÿä¸»æµæ”¯æŒçš„ Emoji åˆ—è¡¨ï¼ˆUnicode 13.0+ï¼Œå¹¿æ³›å…¼å®¹ï¼Œæ¬¢è¿è‡ªè¡Œè¡¥å……æ‰©å±•ï¼‰
ANDROID_SUPPORTED_EMOJIS = [
    # è¡¨æƒ…ç¬¦å·
    "ğŸ˜€","ğŸ˜","ğŸ˜‚","ğŸ¤£","ğŸ˜ƒ","ğŸ˜„","ğŸ˜…","ğŸ˜†","ğŸ˜‰","ğŸ˜Š","ğŸ˜‹","ğŸ˜","ğŸ˜","ğŸ˜˜","ğŸ¥°","ğŸ˜—","ğŸ˜™","ğŸ˜š",
    "ğŸ™‚","ğŸ¤—","ğŸ¤©","ğŸ¤”","ğŸ¤¨","ğŸ˜","ğŸ˜‘","ğŸ˜¶","ğŸ™„","ğŸ˜","ğŸ˜£","ğŸ˜¥","ğŸ˜®","ğŸ¤","ğŸ˜¯","ğŸ˜ª","ğŸ˜«",
    "ğŸ¥±","ğŸ˜´","ğŸ˜Œ","ğŸ˜›","ğŸ˜œ","ğŸ˜","ğŸ¤¤","ğŸ˜’","ğŸ˜“","ğŸ˜”","ğŸ˜•","ğŸ™ƒ","ğŸ¤‘","ğŸ˜²","â˜¹ï¸","ğŸ™","ğŸ˜–",
    "ğŸ˜","ğŸ˜Ÿ","ğŸ˜¤","ğŸ˜¢","ğŸ˜­","ğŸ˜¦","ğŸ˜§","ğŸ˜¨","ğŸ˜©","ğŸ¤¯","ğŸ˜¬","ğŸ˜°","ğŸ˜±","ğŸ¥µ","ğŸ¥¶","ğŸ˜³","ğŸ¤ª",
    "ğŸ˜µ","ğŸ˜¡","ğŸ˜ ","ğŸ¤¬","ğŸ˜·","ğŸ¤’","ğŸ¤•","ğŸ¤¢","ğŸ¤®","ğŸ¤§","ğŸ˜‡","ğŸ¥³","ğŸ¥º","ğŸ¥²","ğŸ¤ ","ğŸ¥¸","ğŸ¤“",
    "ğŸ§","ğŸ« ","ğŸ¤–","ğŸ‘»","ğŸ’€","â˜ ï¸","ğŸ‘½","ğŸ‘¾","ğŸ‘¹","ğŸ‘º","ğŸ’©","ğŸ˜º","ğŸ˜¸","ğŸ˜¹","ğŸ˜»","ğŸ˜¼","ğŸ˜½",
    "ğŸ™€","ğŸ˜¿","ğŸ˜¾","ğŸ™ˆ","ğŸ™‰","ğŸ™Š",
    # å¤©æ°”ä¸è‡ªç„¶
    "ğŸŒ","ğŸŒ","ğŸŒš","ğŸŒ•","ğŸŒ–","ğŸŒ—","ğŸŒ˜","ğŸŒ‘","ğŸŒ’","ğŸŒ“","ğŸŒ”","ğŸŒ™","ğŸŒ","ğŸŒ","ğŸŒ","ğŸª","â­","ğŸŒŸ",
    "âœ¨","âš¡","â˜„ï¸","ğŸ’¥","ğŸ”¥","ğŸŒªï¸","ğŸŒˆ","â˜€ï¸","ğŸŒ¤ï¸","â›…","ğŸŒ¥ï¸","â˜ï¸","ğŸŒ¦ï¸","ğŸŒ§ï¸","â›ˆï¸","ğŸŒ©ï¸","ğŸŒ¨ï¸",
    "â„ï¸","â˜ƒï¸","â›„","ğŸŒ¬ï¸","ğŸ’¨","ğŸ’§","ğŸ’¦","â˜”","â˜‚ï¸","ğŸŒŠ","ğŸŒ«ï¸",
    # åŠ¨ç‰©ä¸è‡ªç„¶
    "ğŸ¶","ğŸ±","ğŸ­","ğŸ¹","ğŸ°","ğŸ¦Š","ğŸ»","ğŸ¼","ğŸ¨","ğŸ¯","ğŸ¦","ğŸ®","ğŸ·","ğŸ½","ğŸ¸","ğŸµ","ğŸ™ˆ","ğŸ™‰","ğŸ™Š",
    "ğŸ’","ğŸ”","ğŸ§","ğŸ¦","ğŸ¤","ğŸ£","ğŸ¥","ğŸ¦†","ğŸ¦…","ğŸ¦‰","ğŸ¦‡","ğŸº","ğŸ—","ğŸ´","ğŸ¦„","ğŸ","ğŸ›","ğŸ¦‹",
    "ğŸŒ","ğŸš","ğŸ","ğŸœ","ğŸ¦—","ğŸ•·ï¸","ğŸ¦‚","ğŸ¢","ğŸ","ğŸ¦","ğŸ¦–","ğŸ¦•","ğŸ™","ğŸ¦‘","ğŸ¦","ğŸ¦","ğŸ¦€","ğŸ¡",
    "ğŸ ","ğŸŸ","ğŸ¬","ğŸ³","ğŸ‹","ğŸ¦ˆ","ğŸŠ","ğŸ…","ğŸ†","ğŸ˜","ğŸ¦","ğŸ¦›","ğŸª","ğŸ«","ğŸ¦™","ğŸ¦’","ğŸƒ","ğŸ‚",
    "ğŸ„","ğŸ","ğŸ–","ğŸ","ğŸ‘","ğŸ","ğŸ¦Œ","ğŸ•","ğŸ©","ğŸ¦®","ğŸ•â€ğŸ¦º","ğŸˆ","ğŸ“","ğŸ¦ƒ","ğŸ¦š","ğŸ¦œ","ğŸ¦¢",
    "ğŸ¦©","ğŸ•Šï¸","ğŸ‡","ğŸ¦","ğŸ¦¨","ğŸ¦¡","ğŸ¦¦","ğŸ¦¥","ğŸ","ğŸ€","ğŸ¿ï¸","ğŸ¦”",
    # é£Ÿç‰©ä¸é¥®æ–™
    "ğŸ","ğŸ","ğŸ","ğŸŠ","ğŸ‹","ğŸŒ","ğŸ‰","ğŸ‡","ğŸ“","ğŸ«","ğŸˆ","ğŸ’","ğŸ‘","ğŸ¥­","ğŸ","ğŸ¥¥","ğŸ¥",
    "ğŸ…","ğŸ†","ğŸ¥‘","ğŸ¥¦","ğŸ¥¬","ğŸ¥’","ğŸŒ¶ï¸","ğŸ«‘","ğŸŒ½","ğŸ¥•","ğŸ«’","ğŸ§„","ğŸ§…","ğŸ¥”","ğŸ ","ğŸ¥","ğŸ¥¯",
    "ğŸ","ğŸ¥–","ğŸ¥¨","ğŸ§€","ğŸ¥š","ğŸ³","ğŸ¥","ğŸ§‡","ğŸ¥“","ğŸ¥©","ğŸ—","ğŸ–","ğŸ¦´","ğŸŒ­","ğŸ”","ğŸŸ","ğŸ•",
    "ğŸ¥ª","ğŸ¥™","ğŸ§†","ğŸŒ®","ğŸŒ¯","ğŸ«”","ğŸ¥—","ğŸ¥˜","ğŸ«•","ğŸ","ğŸœ","ğŸ²","ğŸ›","ğŸ£","ğŸ±","ğŸ¥Ÿ","ğŸ¦ª",
    "ğŸ¤","ğŸ™","ğŸš","ğŸ˜","ğŸ¥","ğŸ¥ ","ğŸ¥®","ğŸ¢","ğŸ¡","ğŸ§","ğŸ¨","ğŸ¦","ğŸ¥§","ğŸ§","ğŸ°","ğŸ‚","ğŸ®",
    "ğŸ­","ğŸ¬","ğŸ«","ğŸ¿","ğŸ©","ğŸª","ğŸ¥›","ğŸ¼","â˜•","ğŸ«–","ğŸµ","ğŸ§ƒ","ğŸ¥¤","ğŸ§‹","ğŸ¶","ğŸº","ğŸ»",
    "ğŸ¥‚","ğŸ·","ğŸ¥ƒ","ğŸ§‰","ğŸ¸","ğŸ¹","ğŸ§Š","ğŸ¥„","ğŸ´","ğŸ½ï¸","ğŸ¥£","ğŸ¥¡","ğŸ¥¢","ğŸ§‚",
    # æ´»åŠ¨
    "âš½","ğŸ€","ğŸˆ","âš¾","ğŸ¥","ğŸ¾","ğŸ","ğŸ‰","ğŸ¥","ğŸ±","ğŸª€","ğŸ“","ğŸ¸","ğŸ’","ğŸ‘","ğŸ¥","ğŸ",
    "ğŸªƒ","ğŸ¥…","â›³","ğŸª","ğŸ¹","ğŸ£","ğŸ¤¿","ğŸ¥Š","ğŸ¥‹","ğŸ½","ğŸ›¹","ğŸ›·","â›¸ï¸","ğŸ¥Œ","ğŸ›¶","â›µ","ğŸš¤",
    "ğŸ›¥ï¸","ğŸ›³ï¸","â›´ï¸","ğŸš¢","âœˆï¸","ğŸ›©ï¸","ğŸš","ğŸšŸ","ğŸš ","ğŸš¡","ğŸš€","ğŸ›¸",
    # ç‰©å“
    "âŒš","ğŸ“±","ğŸ“²","ğŸ’»","âŒ¨ï¸","ğŸ–¥ï¸","ğŸ–¨ï¸","ğŸ–±ï¸","ğŸ–²ï¸","ğŸ•¹ï¸","ğŸ—œï¸","ğŸ’½","ğŸ’¾","ğŸ’¿","ğŸ“€","ğŸ“¼",
    "ğŸ“·","ğŸ“¸","ğŸ“¹","ğŸ¥","ğŸ“½ï¸","ğŸï¸","ğŸ“","â˜ï¸","ğŸ“Ÿ","ğŸ“ ","ğŸ“º","ğŸ“»","ğŸ™ï¸","ğŸšï¸","ğŸ›ï¸","â±ï¸",
    "â²ï¸","â°","ğŸ•°ï¸","âŒ›","â³","ğŸ“¡","ğŸ”‹","ğŸ”Œ","ğŸ’¡","ğŸ”¦","ğŸ•¯ï¸","ğŸ§¯","ğŸ›¢ï¸","ğŸ’¸","ğŸ’µ","ğŸ’´",
    "ğŸ’¶","ğŸ’·","ğŸª™","ğŸ’°","ğŸ’³","ğŸ§¾","ğŸ’","âš–ï¸","ğŸªœ","ğŸ§°","ğŸª›","ğŸ”§","ğŸ”¨","âš’ï¸","ğŸ› ï¸","â›ï¸",
    "ğŸ”©","âš™ï¸","ğŸ—œï¸","âš—ï¸","ğŸ§ª","ğŸ§«","ğŸ§¬","ğŸ”¬","ğŸ”­","ğŸ“¡","ğŸ’‰","ğŸ’Š","ğŸ©¹","ğŸ©º","ğŸšª","ğŸ›ï¸",
    "ğŸ›‹ï¸","ğŸª‘","ğŸš½","ğŸš¿","ğŸ›","ğŸª","ğŸªŸ","ğŸ§´","ğŸ§·","ğŸ§¹","ğŸ§º","ğŸ§»","ğŸª ","ğŸš¬","âš°ï¸","ğŸª¦","âš±ï¸",
    "ğŸ—¿","ğŸª§","ğŸªª",
    # äº¤é€š
    "ğŸš—","ğŸš•","ğŸš™","ğŸšŒ","ğŸš","ğŸï¸","ğŸš“","ğŸš‘","ğŸš’","ğŸš","ğŸ›»","ğŸšš","ğŸš›","ğŸšœ","ğŸ¦½","ğŸ¦¼","ğŸ›´",
    "ğŸš²","ğŸ›µ","ğŸï¸","ğŸ›º","ğŸš¨","ğŸš”","ğŸš","ğŸš˜","ğŸš–","ğŸš¡","ğŸš ","ğŸšŸ","ğŸšƒ","ğŸš‹","ğŸš","ğŸš","ğŸš„",
    "ğŸš…","ğŸšˆ","ğŸš‚","ğŸš†","ğŸš‡","ğŸšŠ","ğŸš‰","âœˆï¸","ğŸ›«","ğŸ›¬","ğŸ›©ï¸","ğŸ’º","ğŸ›°ï¸","ğŸš€","ğŸ›¸","ğŸš","ğŸ›¶",
    # æ——å¸œï¼ˆå–éƒ¨åˆ†å¸¸ç”¨çš„ï¼Œå®‰å“å…¨é¢æ”¯æŒï¼‰
    "ğŸ³ï¸","ğŸ´","ğŸ","ğŸš©","ğŸ³ï¸â€ğŸŒˆ","ğŸ³ï¸â€âš§ï¸","ğŸ‡¨ğŸ‡³","ğŸ‡ºğŸ‡¸","ğŸ‡¬ğŸ‡§","ğŸ‡«ğŸ‡·","ğŸ‡¯ğŸ‡µ","ğŸ‡°ğŸ‡·","ğŸ‡©ğŸ‡ª","ğŸ‡·ğŸ‡º",
    "ğŸ‡®ğŸ‡³","ğŸ‡®ğŸ‡©","ğŸ‡§ğŸ‡·","ğŸ‡¦ğŸ‡º","ğŸ‡¨ğŸ‡¦","ğŸ‡¸ğŸ‡¬","ğŸ‡¹ğŸ‡¼","ğŸ‡­ğŸ‡°","ğŸ‡¹ğŸ‡­","ğŸ‡®ğŸ‡¹","ğŸ‡ªğŸ‡¸","ğŸ‡²ğŸ‡½","ğŸ‡¸ğŸ‡ª","ğŸ‡³ğŸ‡±",
    "ğŸ‡¹ğŸ‡·","ğŸ‡¸ğŸ‡¦","ğŸ‡¦ğŸ‡ª","ğŸ‡¨ğŸ‡­","ğŸ‡³ğŸ‡¿","ğŸ‡²ğŸ‡¾","ğŸ‡³ğŸ‡´","ğŸ‡©ğŸ‡°","ğŸ‡«ğŸ‡®","ğŸ‡µğŸ‡¹","ğŸ‡µğŸ‡±","ğŸ‡§ğŸ‡ª","ğŸ‡¦ğŸ‡·","ğŸ‡¿ğŸ‡¦",
    "ğŸ‡ªğŸ‡¬"
]

# æ›¿æ¢ç”¨çš„ emoji é›†åˆ
REPLACEMENT_EMOJIS = ANDROID_SUPPORTED_EMOJIS.copy()

# æ„é€ æ­£åˆ™ï¼šåŒ¹é…æ‰€æœ‰å®‰å“ä¸»æµæ”¯æŒçš„ Emoji
# è¿™é‡Œé‡‡ç”¨åˆ†ç»„æ‹¼æ¥æ‰€æœ‰ emoji å­—ç¬¦ï¼Œä¿è¯ç²¾ç¡®åŒ¹é…æ¯ä¸€ä¸ªå•ä½“ emoji
TARGET_EMOJI_PATTERN = re.compile(
    r'({})'.format('|'.join(re.escape(emoji) for emoji in ANDROID_SUPPORTED_EMOJIS))
)

def replace_android_emojis_in_line(line, used_emojis):
    """
    æ›¿æ¢ä¸€è¡Œä¸­æ‰€æœ‰å®‰å“æ”¯æŒçš„ emojiï¼ˆæ¯ä¸ªæ–° emoji å…¨å±€ä¸é‡å¤ï¼Œç›´åˆ°ç”¨å°½ï¼‰ï¼Œå…¶ä»–å†…å®¹ä¸å˜ã€‚
    """
    def emoji_replacer(match):
        available = list(set(REPLACEMENT_EMOJIS) - used_emojis)
        if not available:
            available = REPLACEMENT_EMOJIS  # ç”¨å°½åå…è®¸é‡å¤
        chosen = random.choice(available)
        used_emojis.add(chosen)
        return chosen
    return TARGET_EMOJI_PATTERN.sub(emoji_replacer, line)

def process_file(input_path, output_path):
    """
    é€è¡Œå¤„ç†æ–‡ä»¶ï¼šåªæ›¿æ¢å®‰å“æ”¯æŒçš„ emojiï¼Œå…¶ä»–å†…å®¹ï¼ˆå­—æ¯/æ•°å­—/æ ‡ç‚¹/ç¼©è¿›/æ¢è¡Œ/ä¸­æ–‡ç­‰ï¼‰å…¨éƒ¨ä¿ç•™
    """
    try:
        with open(input_path, 'r', encoding='utf-8') as f:
            lines = f.readlines()
    except Exception as e:
        print(f"è¯»å–æ–‡ä»¶å¤±è´¥: {input_path}, é”™è¯¯: {e}")
        return
    used_emojis = set()
    processed_lines = []
    for line in lines:
        replaced_line = replace_android_emojis_in_line(line, used_emojis)
        processed_lines.append(replaced_line)
    try:
        with open(output_path, 'w', encoding='utf-8') as f:
            f.writelines(processed_lines)
        print(f"å·²ç”Ÿæˆæ–‡ä»¶: {output_path}")
    except Exception as e:
        print(f"å†™å…¥æ–‡ä»¶å¤±è´¥: {output_path}, é”™è¯¯: {e}")

def main():
    """
    é»˜è®¤å¤„ç† emojis ç›®å½•ä¸‹æ‰€æœ‰ .json æ–‡ä»¶ï¼Œç»“æœä¿å­˜åœ¨ emojis/output/ ä¸‹ï¼Œæ–‡ä»¶åä¿æŒä¸€è‡´
    """
    script_dir = os.path.dirname(os.path.abspath(__file__))
    emojis_dir = script_dir
    output_dir = os.path.join(emojis_dir, "output")
    os.makedirs(output_dir, exist_ok=True)
    for file in os.listdir(emojis_dir):
        if file.endswith('.json'):
            input_path = os.path.join(emojis_dir, file)
            output_path = os.path.join(output_dir, file)
            process_file(input_path, output_path)

if __name__ == "__main__":
    main()
